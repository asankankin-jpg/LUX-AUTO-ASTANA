<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Админ-панель — Система управления</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { background: #f0f2f5; padding: 40px 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        .admin-container { 
            max-width: 1100px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            border-radius: 15px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            display: none; /* Скрыто до ввода пароля */
        }
        
        .admin-header { 
            border-bottom: 2px solid #eee; 
            margin-bottom: 30px; 
            padding-bottom: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }

        /* Статистика */
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .stat-card { 
            padding: 20px; 
            border-radius: 12px; 
            text-align: center; 
            color: white;
        }
        .stat-blue { background: linear-gradient(135deg, #007bff, #0056b3); }
        .stat-green { background: linear-gradient(135deg, #28a745, #1e7e34); }
        .stat-orange { background: linear-gradient(135deg, #fd7e14, #d96d00); }
        
        .stat-value { font-size: 24px; font-weight: bold; margin-top: 5px; }
        .stat-label { font-size: 14px; opacity: 0.9; }

        /* Вкладки */
        .tabs { display: flex; gap: 10px; margin-bottom: 25px; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
        .tab-btn { 
            padding: 10px 20px; border: none; border-radius: 5px; 
            cursor: pointer; background: #eee; font-weight: bold; transition: 0.3s; 
        }
        .tab-btn.active { background: #333; color: white; }

        /* Таблицы */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; background: #fff; }
        th { background: #f8f9fa; color: #333; text-align: left; padding: 15px; border-bottom: 2px solid #dee2e6; }
        td { padding: 15px; border-bottom: 1px solid #eee; font-size: 14px; }
        tr:hover { background: #f9f9f9; }

        .badge { 
            padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold; 
            background: #e9ecef; color: #495057; 
        }
        
        .clear-btn { 
            background: #dc3545; color: white; border: none; padding: 10px 20px; 
            border-radius: 5px; cursor: pointer; float: right; margin-top: 20px; 
        }
        .clear-btn:hover { background: #c82333; }
    </style>
</head>
<body>

<div id="adminContent" class="admin-container">
    <div class="admin-header">
        <h1>Панель управления</h1>
        <a href="index.html" class="test-drive-btn" style="background: #6c757d;">Вернуться на сайт</a>
    </div>

    <div class="stats-grid">
        <div class="stat-card stat-blue">
            <div class="stat-label">Всего заказов</div>
            <div id="countOrders" class="stat-value">0</div>
        </div>
        <div class="stat-card stat-green">
            <div class="stat-label">Общая сумма</div>
            <div id="sumOrders" class="stat-value">0 ₸</div>
        </div>
        <div class="stat-card stat-orange">
            <div class="stat-label">Записей на тест-драйв</div>
            <div id="countTests" class="stat-value">0</div>
        </div>
    </div>

    <div class="tabs">
        <button id="btnBuy" class="tab-btn active" onclick="switchTab('buy')">Заявки на покупку</button>
        <button id="btnTest" class="tab-btn" onclick="switchTab('test')">Тест-драйвы</button>
    </div>

    <div id="sectionBuy">
        <table>
            <thead>
                <tr>
                    <th>Дата</th>
                    <th>Автомобиль</th>
                    <th>Стоимость</th>
                </tr>
            </thead>
            <tbody id="listBuy"></tbody>
        </table>
    </div>

    <div id="sectionTest" style="display:none;">
        <table>
            <thead>
                <tr>
                    <th>Дата</th>
                    <th>Имя</th>
                    <th>Телефон</th>
                    <th>Модель</th>
                </tr>
            </thead>
            <tbody id="listTest"></tbody>
        </table>
    </div>

    <button class="clear-btn" onclick="clearData()">Очистить все данные</button>
</div>

<script>
    // Проверка пароля
    const password = prompt("Введите пароль администратора:");
    if (password === "1234") {
        document.getElementById("adminContent").style.display = "block";
        renderData();
    } else {
        alert("Неверный пароль!");
        window.location.href = "index.html";
    }

    function switchTab(type) {
        document.getElementById('sectionBuy').style.display = type === 'buy' ? 'block' : 'none';
        document.getElementById('sectionTest').style.display = type === 'test' ? 'block' : 'none';
        
        document.getElementById('btnBuy').classList.toggle('active', type === 'buy');
        document.getElementById('btnTest').classList.toggle('active', type === 'test');
    }

    function renderData() {
        const buys = JSON.parse(localStorage.getItem('purchases') || '[]');
        const tests = JSON.parse(localStorage.getItem('testdrives') || '[]');

        // Статистика
        document.getElementById('countOrders').innerText = buys.length;
        document.getElementById('countTests').innerText = tests.length;
        
        let totalSum = buys.reduce((acc, curr) => {
            let price = parseInt(curr.price.replace(/[^0-9]/g, '')) || 0;
            return acc + price;
        }, 0);
        document.getElementById('sumOrders').innerText = totalSum.toLocaleString() + ' ₸';

        // Список покупок
        const listBuy = document.getElementById('listBuy');
        listBuy.innerHTML = buys.length ? buys.map(b => `
            <tr>
                <td style="color:#888">${b.date}</td>
                <td><span class="badge">${b.car}</span></td>
                <td style="font-weight:bold; color:#28a745">${b.price}</td>
            </tr>
        `).join('') : '<tr><td colspan="3" style="text-align:center; padding:30px; color:#999">Заказов пока нет</td></tr>';

        // Список тест-драйвов
        const listTest = document.getElementById('listTest');
        listTest.innerHTML = tests.length ? tests.map(t => `
            <tr>
                <td style="color:#888">${t.date}</td>
                <td style="font-weight:bold">${t.name}</td>
                <td>${t.phone}</td>
                <td><span class="badge" style="background:#fff3e0; color:#e65100">${t.car || 'Не выбрано'}</span></td>
            </tr>
        `).join('') : '<tr><td colspan="4" style="text-align:center; padding:30px; color:#999">Записей пока нет</td></tr>';
    }

    function clearData() {
        if (confirm("Удалить всю историю заказов и записей?")) {
            localStorage.clear();
            renderData();
        }
    }
</script>

</body>
</html>